<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Library</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <nav>
    <a href="{{ url_for('home') }}">Home</a>
    <a href="{{ url_for('add_author') }}">Add Author</a>
    <a href="{{ url_for('add_book') }}">Add Book</a>
  </nav>

  <div class="container">
    <h1>Library Home</h1>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <p class="{{ category }}">{{ message }}</p>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- Search -->
    <form action="{{ url_for('home') }}" method="GET" style="text-align:center; margin-bottom:20px;">
      <input type="text" name="keyword" placeholder="Search books..." value="{{ request.args.get('keyword', '') }}" style="padding:8px; width:60%;">
      <button type="submit">Search üîç</button>
    </form>

    <!-- Sort Options -->
    <p>Sort by:
      <a href="{{ url_for('home', sort='title', keyword=request.args.get('keyword', '')) }}">Title</a> |
      <a href="{{ url_for('home', sort='author', keyword=request.args.get('keyword', '')) }}">Author</a>
    </p>

    <h2>Books</h2>
    <ul>
      {% if books %}
        {% for book in books %}
          <li>
            <img src="https://covers.openlibrary.org/b/isbn/{{ book.isbn }}-M.jpg" alt="Cover">
            <div>
              <strong>{{ book.title }}</strong> by {{ book.author.name }}
              {% if book.publication_year %} ({{ book.publication_year }}) {% endif %}
              <br>ISBN: {{ book.isbn }}

              <!-- Delete Button -->
              <form action="{{ url_for('delete_book', book_id=book.id) }}"
                    method="POST" style="display:inline;">
                  <button type="submit" title="Delete Book"
                          style="background:none; border:none; cursor:pointer; color:#e74c3c; font-size:18px;"
                          onclick="return confirmDelete();">
                          üóëÔ∏è
                  </button>
              </form>
            </div>
          </li>
        {% endfor %}
      {% else %}
        <p>No books found for your search.</p>
      {% endif %}
    </ul>
  </div>
<script>
    function confirmDelete() {
    return confirm("Are you sure you want to delete this book?");
    }
</script>
</body>
</html>
